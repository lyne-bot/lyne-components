@use '../../global/styles' as sbb;

// Default component properties, defined for :host. Properties which can not
// travel the shadow boundary are defined through this mixin
@include sbb.host-component-properties;

:host {
  --sbb-loading-indicator-color: var(--sbb-color-red-default);

  display: inline-block;
  line-height: 0;
}

:host([variant='circle']) {
  --sbb-loading-indicator-height: var(--sbb-size-icon-ui-small);
  --sbb-loading-indicator-width: var(--sbb-size-icon-ui-small);
  --sbb-loading-indicator-padding: var(--sbb-border-width-2x);
  --sbb-loading-indicator-duration: 1.5s;
  --sbb-loading-indicator-background-color: var(--sbb-color-white-default);
  --sbb-loading-indicator-circle-background: conic-gradient(
    from 90deg,
    var(--sbb-loading-indicator-background-color),
    var(--sbb-loading-indicator-color)
  );
  --sbb-loading-indicator-circle-animated-width: sbb.px-to-rem-build(3);
  --sbb-loading-indicator-circle-animated-height: sbb.px-to-rem-build(3);
  --sbb-loading-indicator-circle-animated-border-radius: 50%;
}

:host([variant='circle']) .sbb-loading-indicator {
  height: var(--sbb-loading-indicator-height);
  width: var(--sbb-loading-indicator-width);
  padding-inline: var(--sbb-loading-indicator-padding);
  padding-block: var(--sbb-loading-indicator-padding);
  display: inline-block;
}

:host([variant='circle']) .sbb-loading-indicator__animated-element {
  width: 100%;
  height: 100%;
  display: inline-block;
  color: transparent;
  position: relative;
  margin: 0 auto;
  overflow: hidden;
  border-radius: 50%;
  background: var(--sbb-loading-indicator-circle-background);
  /* stylelint-disable-next-line property-no-vendor-prefix */
  -webkit-mask: radial-gradient(
    circle sbb.px-to-rem-build(7),
    #0000 98%,
    var(--sbb-loading-indicator-background-color)
  );
  mask: radial-gradient(
    circle sbb.px-to-rem-build(7),
    #0000 98%,
    var(--sbb-loading-indicator-background-color)
  );
  animation: rotation var(--sbb-loading-indicator-duration) infinite linear;

  &::after {
    content: '';
    width: var(--sbb-loading-indicator-circle-animated-width);
    height: var(--sbb-loading-indicator-circle-animated-height);
    background: var(--sbb-loading-indicator-color);
    border-radius: var(--sbb-loading-indicator-circle-animated-border-radius);
    position: absolute;
    top: 50%;
    right: 0;
    transform: translateY(-50%);
    overflow: hidden;
    margin: auto;
    @include sbb.if-forced-colors {
      --sbb-loading-indicator-color: CanvasText;
      --sbb-loading-indicator-circle-animated-width: 50%;
      --sbb-loading-indicator-circle-animated-height: 100%;
      --sbb-loading-indicator-circle-animated-border-radius: 0;
    }
  }

  @include sbb.if-forced-colors {
    --sbb-loading-indicator-circle-background: transparent;
  }
}

:host([variant='window']) {
  --sbb-loading-indicator-height: sbb.px-to-rem-build(32);
  --sbb-loading-indicator-width: sbb.px-to-rem-build(55);
  --sbb-loading-indicator-padding: 0;
  --sbb-loading-indicator-duration: 0.23s;
}

:host([variant='window'][size='small']) {
  --sbb-loading-indicator-window-height: 1.66665em;
  --sbb-loading-indicator-window-padding-block-start: 0.66666em;
  --sbb-loading-indicator-window-element-width: 3.46665em;
  --sbb-loading-indicator-window-element-height: 0.33333em;
  --sbb-loading-indicator-window-element-perspective: 6em;
  --sbb-loading-indicator-window-element-animation: loading-container-small
    var(--sbb-loading-indicator-duration) linear infinite;
  --sbb-loading-indicator-window-last-span-width: 0.53333em;
  --sbb-loading-indicator-window-last-span-height: 0.33333em;
  --sbb-loading-indicator-window-last-span-margin: 0.2em;
  --sbb-loading-indicator-window-last-span-transform: translate3d(-0.1em, 0, 0);
}

:host([variant='window'][size='large']) {
  --sbb-loading-indicator-window-height: 3em;
  --sbb-loading-indicator-window-padding-block-start: 1.2em;
  --sbb-loading-indicator-window-element-width: 5.8em;
  --sbb-loading-indicator-window-element-height: 0.6em;
  --sbb-loading-indicator-window-element-perspective: 8em;
  --sbb-loading-indicator-window-element-animation: loading-container-large
    var(--sbb-loading-indicator-duration) linear infinite;
  --sbb-loading-indicator-window-last-span-width: 1em;
  --sbb-loading-indicator-window-last-span-height: 0.6em;
  --sbb-loading-indicator-window-last-span-margin: 0.2em;
}

:host([variant='window']) span {
  display: inline-block;
}

:host([variant='window']) .sbb-loading-indicator {
  display: flex;
  height: var(--sbb-loading-indicator-window-height);
  padding-block-start: var(--sbb-loading-indicator-window-padding-block-start);
}

:host([variant='window']) .sbb-loading-indicator__animated-element {
  margin: 0 auto;
  transform-origin: center;
  transform: translate3d(-3em, 0, 0);
  backface-visibility: hidden;
  transform-style: preserve-3d;
  width: var(--sbb-loading-indicator-window-element-width);
  height: var(--sbb-loading-indicator-window-element-height);
  perspective: var(--sbb-loading-indicator-window-element-perspective);
}

:host([variant='window']) .sbb-loading-indicator__animated-element > span {
  position: relative;
  transform: rotateY(50deg) translateZ(1em);
  transform-origin: right;
  backface-visibility: hidden;
}

:host([variant='window']) .sbb-loading-indicator__animated-element > span > span {
  position: relative;
  display: flex;
  animation: var(--sbb-loading-indicator-window-element-animation);
}

:host([variant='window']) .sbb-loading-indicator__animated-element > span > span > span {
  background: var(--sbb-loading-indicator-color);
  backface-visibility: hidden;
  outline: var(--sbb-border-width-1x) solid rgb(0 0 0 / 0%);
  width: var(--sbb-loading-indicator-window-last-span-width);
  height: var(--sbb-loading-indicator-window-last-span-height);
  margin-right: var(--sbb-loading-indicator-window-last-span-margin);
  transform: var(--sbb-loading-indicator-window-last-span-transform);

  &:nth-child(1) {
    animation: loading-rectangle1 var(--sbb-loading-indicator-duration) linear infinite;
  }

  &:nth-child(2) {
    animation: loading-rectangle2 var(--sbb-loading-indicator-duration) linear infinite;
  }

  &:nth-child(3) {
    animation: loading-rectangle3 var(--sbb-loading-indicator-duration) linear infinite;
  }

  &:nth-child(4) {
    animation: loading-rectangle4 var(--sbb-loading-indicator-duration) linear infinite;
  }

  &:nth-child(5) {
    animation: loading-rectangle5 var(--sbb-loading-indicator-duration) linear infinite;
  }

  &:last-child {
    margin-right: 0;
  }
}

@keyframes loading-container-small {
  0% {
    transform: translateX(0.73333em);
  }

  100% {
    transform: translateX(0);
  }
}

@keyframes loading-container-large {
  0% {
    transform: translateX(1.2em);
  }

  100% {
    transform: translateX(0);
  }
}

@keyframes loading-rectangle1 {
  0% {
    opacity: 0.5;
  }

  100% {
    opacity: 0;
  }
}

@keyframes loading-rectangle2 {
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0.5;
  }
}

@keyframes loading-rectangle3 {
  0% {
    opacity: 0.5;
  }

  100% {
    opacity: 1;
  }
}

@keyframes loading-rectangle4 {
  0% {
    opacity: 0.25;
  }

  100% {
    opacity: 0.5;
  }
}

@keyframes loading-rectangle5 {
  0% {
    opacity: 0;
  }

  100% {
    opacity: 0.25;
  }
}

@keyframes rotation {
  from {
    transform: rotate(0deg);
  }

  to {
    transform: rotate(359deg);
  }
}
